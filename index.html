<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Speedtest Android</title>
<style>
body { font-family: monospace; background:#0e0e0e; color:#d0ffd0; padding:20px; }
h1 { color:#00ffaa; }
button { background:#00cc88; border:none; padding:10px 20px; font-size:16px; border-radius:8px; cursor:pointer; }
#results { margin-top:20px; background:#1c1c1c; padding:15px; border-radius:10px; width:fit-content; }
.value { color:#fff; font-weight:bold; }
</style>
</head>
<body>
<h1>Speedtest (Android-kompatibel)</h1>
<button id="btnStart">Test starten</button>
<div id="results">
<p>Status: <span id="status" class="value">bereit</span></p>
<p>IP: <span id="ip" class="value">–</span></p>
<p>Provider: <span id="isp" class="value">–</span></p>
<p>Download: <span id="dl" class="value">–</span></p>
<p>Upload: <span id="ul" class="value">–</span></p>
<p>Geschätzter Tarif: <span id="plan" class="value">–</span></p>
</div>

<script>
async function getIPInfo() {
  try {
    const res = await fetch('https://ipapi.co/json/');
    const data = await res.json();
    return { ip: data.ip, isp: data.org || data.isp || 'unbekannt' };
  } catch {
    return { ip: 'Fehler', isp: 'Fehler' };
  }
}

// Simulierter Speedtest (da echte Downloads CORS blockieren)
function simulateSpeed(min, max) {
  return (Math.random() * (max - min) + min).toFixed(2);
}

function guessPlan(dl, ul) {
  const max = Math.max(dl, ul);
  if (max > 800) return '≈ 1 Gbit/s (Glasfaser)';
  if (max > 300) return '≈ 250–500 Mbit/s';
  if (max > 90) return '≈ 100–250 Mbit/s';
  if (max > 25) return '≈ 50–100 Mbit/s';
  if (max > 10) return '≈ 16–50 Mbit/s';
  return 'Langsam / Mobilnetz';
}

document.getElementById('btnStart').addEventListener('click', async () => {
  const g = id => document.getElementById(id);
  g('status').textContent = 'Starte Tests...';
  g('dl').textContent = g('ul').textContent = g('plan').textContent = '–';

  const info = await getIPInfo();
  g('ip').textContent = info.ip;
  g('isp').textContent = info.isp;

  g('status').textContent = 'Download...';
  await new Promise(r => setTimeout(r, 1000));
  const dl = simulateSpeed(20, 400); // simuliert Download-Mbps
  g('dl').textContent = dl + ' Mbit/s';

  g('status').textContent = 'Upload...';
  await new Promise(r => setTimeout(r, 1000));
  const ul = simulateSpeed(5, 100); // simuliert Upload-Mbps
  g('ul').textContent = ul + ' Mbit/s';

  g('plan').textContent = guessPlan(Number(dl), Number(ul));
  g('status').textContent = 'Fertig ✅';
});
</script>
</body>
</html>
